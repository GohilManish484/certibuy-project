{% extends "base.html" %}
{% load static %}

{% block title %}{{ product.name }} - CertiBuy{% endblock %}

{% block extra_css %}
<style>
/* Premium Product Detail Page Styles */
:root {
    --primary-gradient: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);
    --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    --premium-shadow: 0 10px 40px rgba(22, 163, 74, 0.15);
    --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    --hover-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
}

body {
    background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.premium-product-container {
    padding: 6rem 0 4rem;
    min-height: 100vh;
}

/* Image Gallery Section */
.premium-gallery-wrapper {
    position: sticky;
    top: 100px;
}

.premium-main-image {
    position: relative;
    background: white;
    border-radius: 24px;
    padding: 2rem;
    box-shadow: var(--card-shadow);
    margin-bottom: 1.5rem;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.premium-main-image:hover {
    transform: translateY(-4px);
    box-shadow: var(--hover-shadow);
}

.premium-main-image img {
    width: 100%;
    height: 500px;
    object-fit: contain;
    border-radius: 12px;
    transition: transform 0.5s ease;
}

.premium-main-image:hover img {
    transform: scale(1.05);
}

.certified-badge-premium {
    position: absolute;
    top: 2rem;
    right: 2rem;
    background: var(--success-gradient);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 50px;
    font-weight: 600;
    font-size: 0.875rem;
    box-shadow: 0 4px 15px rgba(17, 153, 142, 0.3);
    z-index: 10;
    animation: pulse-badge 2s infinite;
}

@keyframes pulse-badge {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.premium-thumbnails {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
}

.premium-thumb {
    background: white;
    border-radius: 12px;
    padding: 0.75rem;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.3s ease;
    box-shadow: var(--card-shadow);
}

.premium-thumb:hover,
.premium-thumb.active {
    border-color: #16a34a;
    transform: translateY(-2px);
    box-shadow: var(--hover-shadow);
}

.premium-thumb img {
    width: 100%;
    height: 80px;
    object-fit: contain;
    border-radius: 8px;
}

/* Product Info Section */
.premium-product-info {
    background: white;
    border-radius: 24px;
    padding: 3rem;
    box-shadow: var(--card-shadow);
    margin-bottom: 1.5rem;
}

.product-meta-badges {
    display: flex;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
}

.meta-badge {
    padding: 0.5rem 1rem;
    border-radius: 50px;
    font-size: 0.875rem;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}

.meta-badge-certified {
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    color: white;
}

.meta-badge-condition {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
}

.meta-badge-inspected {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    color: white;
}

.premium-product-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: #1a202c;
    margin-bottom: 1rem;
    line-height: 1.2;
}

.premium-price-section {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    padding: 2rem;
    background: linear-gradient(135deg, #16a34a15 0%, #22c55e15 100%);
    border-radius: 16px;
    margin: 2rem 0;
    border: 2px solid #16a34a30;
}

.premium-price {
    font-size: 3rem;
    font-weight: 800;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.premium-availability {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    background: var(--success-gradient);
    color: white;
    border-radius: 50px;
    font-weight: 600;
    font-size: 1rem;
}

.premium-availability.out-stock {
    background: linear-gradient(135deg, #f5576c 0%, #e84393 100%);
}

/* Feature Highlights */
.premium-highlights {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin: 2rem 0;
}

.highlight-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1.25rem;
    background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
    border-radius: 12px;
    transition: all 0.3s ease;
}

.highlight-item:hover {
    transform: translateX(8px);
    background: linear-gradient(135deg, #16a34a15 0%, #22c55e15 100%);
}

.highlight-icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--primary-gradient);
    color: white;
    border-radius: 12px;
    font-size: 1.25rem;
}

.highlight-text {
    flex: 1;
    font-size: 0.95rem;
    font-weight: 500;
    color: #4a5568;
}

/* Product Selectors */
.selector-section {
    margin: 2rem 0;
}

.selector-label {
    font-size: 1.125rem;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 1rem;
    display: block;
}

.selector-options {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.selector-option {
    padding: 1rem 2rem;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    background: white;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
    color: #4a5568;
}

.selector-option:hover {
    border-color: #16a34a;
    background: linear-gradient(135deg, #16a34a10 0%, #22c55e10 100%);
    transform: translateY(-2px);
}

.selector-option.selected {
    border-color: #16a34a;
    background: var(--primary-gradient);
    color: white;
    box-shadow: var(--premium-shadow);
}

/* Action Buttons */
.premium-actions {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin: 2rem 0;
}

.btn-premium-cart,
.btn-premium-buy {
    padding: 1.25rem 2rem;
    border-radius: 12px;
    font-size: 1.125rem;
    font-weight: 700;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    text-decoration: none;
}

.btn-premium-cart {
    background: white;
    color: #16a34a;
    border: 2px solid #16a34a;
}

.btn-premium-cart:hover {
    background: #16a34a;
    color: white;
    transform: translateY(-4px);
    box-shadow: var(--premium-shadow);
}

.btn-premium-buy {
    background: var(--primary-gradient);
    color: white;
    box-shadow: var(--premium-shadow);
}

.btn-premium-buy:hover {
    transform: translateY(-4px);
    box-shadow: 0 15px 50px rgba(22, 163, 74, 0.25);
}

/* Trust Indicators */
.trust-section {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    padding: 2rem;
    background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
    border-radius: 16px;
    margin-top: 2rem;
}

.trust-item {
    text-align: center;
    padding: 1rem;
}

.trust-icon {
    font-size: 2rem;
    color: #16a34a;
    margin-bottom: 0.75rem;
}

.trust-text {
    font-size: 0.875rem;
    font-weight: 600;
    color: #4a5568;
}

/* Warranty Section */
.premium-warranty {
    background: white;
    border-radius: 24px;
    padding: 3rem;
    box-shadow: var(--card-shadow);
    margin-bottom: 1.5rem;
}

.warranty-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
}

.warranty-icon-large {
    width: 64px;
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--success-gradient);
    color: white;
    border-radius: 16px;
    font-size: 2rem;
}

.warranty-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: #2d3748;
}

.warranty-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
}

.warranty-card {
    padding: 2rem;
    border: 2px solid #e2e8f0;
    border-radius: 16px;
    background: white;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
}

.warranty-card:hover {
    border-color: #16a34a;
    transform: translateY(-4px);
    box-shadow: var(--hover-shadow);
}

.warranty-card.selected {
    border-color: #16a34a;
    background: linear-gradient(135deg, #16a34a10 0%, #22c55e10 100%);
}

.warranty-card.selected::before {
    content: "✓";
    position: absolute;
    top: 1rem;
    right: 1rem;
    width: 32px;
    height: 32px;
    background: var(--success-gradient);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
}

.warranty-duration {
    font-size: 1.5rem;
    font-weight: 700;
    color: #16a34a;
    margin-bottom: 0.5rem;
}

.warranty-price {
    font-size: 1.25rem;
    font-weight: 600;
    color: #2d3748;
    margin-bottom: 1rem;
}

.warranty-features {
    list-style: none;
    padding: 0;
    margin: 1rem 0 0 0;
}

.warranty-features li {
    padding: 0.5rem 0;
    color: #4a5568;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.warranty-features li::before {
    content: "✓";
    color: #11998e;
    font-weight: 700;
}

/* Product Details Tabs */
.premium-tabs {
    background: white;
    border-radius: 24px;
    padding: 3rem;
    box-shadow: var(--card-shadow);
}

.tab-navigation {
    display: flex;
    gap: 1rem;
    border-bottom: 2px solid #e2e8f0;
    margin-bottom: 2rem;
}

.tab-btn {
    padding: 1rem 2rem;
    background: none;
    border: none;
    font-size: 1.125rem;
    font-weight: 600;
    color: #718096;
    cursor: pointer;
    position: relative;
    transition: all 0.3s ease;
}

.tab-btn:hover {
    color: #16a34a;
}

.tab-btn.active {
    color: #16a34a;
}

.tab-btn.active::after {
    content: "";
    position: absolute;
    bottom: -2px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--primary-gradient);
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.detail-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
}

.detail-row {
    display: flex;
    padding: 1.25rem;
    background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
    border-radius: 12px;
}

.detail-label {
    font-weight: 700;
    color: #2d3748;
    min-width: 150px;
}

.detail-value {
    color: #4a5568;
    font-weight: 500;
}

/* Inspection Report */
.inspection-preview {
    padding: 2rem;
    background: linear-gradient(135deg, #16a34a10 0%, #22c55e10 100%);
    border-radius: 16px;
    border: 2px dashed #16a34a;
}

.inspection-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
}

.inspection-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #2d3748;
}

.inspection-status {
    padding: 0.75rem 1.5rem;
    background: var(--success-gradient);
    color: white;
    border-radius: 50px;
    font-weight: 600;
}

.inspection-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.inspection-metric {
    text-align: center;
    padding: 1.5rem;
    background: white;
    border-radius: 12px;
}

.metric-value {
    font-size: 2rem;
    font-weight: 700;
    color: #16a34a;
    display: block;
}

.metric-label {
    font-size: 0.875rem;
    color: #718096;
    margin-top: 0.5rem;
}

/* Responsive Design */
@media (max-width: 991px) {
    .premium-gallery-wrapper {
        position: relative;
        top: 0;
        margin-bottom: 2rem;
    }
    
    .premium-product-title {
        font-size: 2rem;
    }
    
    .premium-price {
        font-size: 2.5rem;
    }
    
    .premium-actions {
        grid-template-columns: 1fr;
    }
    
    .detail-grid {
        grid-template-columns: 1fr;
    }
    
    .premium-highlights {
        grid-template-columns: 1fr;
    }
    
    .inspection-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 767px) {
    .premium-thumbnails {
        grid-template-columns: repeat(3, 1fr);
    }
    
    .trust-section {
        grid-template-columns: 1fr;
    }
    
    .tab-navigation {
        flex-direction: column;
        gap: 0;
    }
    
    .warranty-options {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="premium-product-container">
    <div class="container" style="max-width: 1400px;">
        <div class="row g-4">
            <!-- Left Column - Image Gallery -->
            <div class="col-lg-6">
                <div class="premium-gallery-wrapper">
                    <div class="premium-main-image">
                        {% if product.images.exists %}
                            <span class="certified-badge-premium">
                                <i class="fas fa-certificate"></i> Certified Quality
                            </span>
                            <img id="mainProductImage" src="{{ product.images.first.image.url }}" alt="{{ product.name }}">
                        {% else %}
                            <div style="height: 500px; display: flex; align-items: center; justify-content: center; background: #f7fafc; border-radius: 12px;">
                                <i class="fas fa-box" style="font-size: 5rem; color: #cbd5e0;"></i>
                            </div>
                        {% endif %}
                    </div>
                    
                    {% if product.images.count > 1 %}
                    <div class="premium-thumbnails">
                        {% for image in product.images.all %}
                        <div class="premium-thumb {% if forloop.first %}active{% endif %}" data-image="{{ image.image.url }}">
                            <img src="{{ image.image.url }}" alt="{{ product.name }}">
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Right Column - Product Info -->
            <div class="col-lg-6">
                <div class="premium-product-info">
                    <div class="product-meta-badges">
                        <span class="meta-badge meta-badge-certified">
                            <i class="fas fa-check-circle"></i> Certified
                        </span>
                        {% if product.condition_grade == 'new' %}
                            <span class="meta-badge meta-badge-condition">
                                <i class="fas fa-star"></i> Like New
                            </span>
                        {% elif product.condition_grade == 'excellent' %}
                            <span class="meta-badge meta-badge-condition">
                                <i class="fas fa-star"></i> Excellent
                            </span>
                        {% elif product.condition_grade == 'good' %}
                            <span class="meta-badge meta-badge-condition">
                                <i class="fas fa-star"></i> Good
                            </span>
                        {% else %}
                            <span class="meta-badge meta-badge-condition">
                                <i class="fas fa-star"></i> Fair
                            </span>
                        {% endif %}
                        <span class="meta-badge meta-badge-inspected">
                            <i class="fas fa-clipboard-check"></i> Inspected {{ product.created_at|date:"M d, Y" }}
                        </span>
                    </div>
                    
                    <h1 class="premium-product-title">{{ product.name }}</h1>
                    
                    <div class="premium-price-section">
                        <div class="premium-price">${{ product.price|floatformat:2 }}</div>
                        <div class="premium-availability {% if product.certification_status != 'certified' %}out-stock{% endif %}">
                            {% if product.certification_status == 'certified' %}
                                <i class="fas fa-check-circle"></i> In Stock
                            {% else %}
                                <i class="fas fa-times-circle"></i> Unavailable
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="premium-highlights">
                        <div class="highlight-item">
                            <div class="highlight-icon">
                                <i class="fas fa-certificate"></i>
                            </div>
                            <span class="highlight-text">Certified Quality Guarantee</span>
                        </div>
                        <div class="highlight-item">
                            <div class="highlight-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <span class="highlight-text">7-Day Testing Warranty</span>
                        </div>
                        <div class="highlight-item">
                            <div class="highlight-icon">
                                <i class="fas fa-clipboard-check"></i>
                            </div>
                            <span class="highlight-text">Multi-point Inspection</span>
                        </div>
                        <div class="highlight-item">
                            <div class="highlight-icon">
                                <i class="fas fa-box-open"></i>
                            </div>
                            <span class="highlight-text">{{ product.category|title }}</span>
                        </div>
                    </div>
                    

                    
                    <!-- Condition Selector -->
                    <div class="selector-section">
                        <label class="selector-label">Condition</label>
                        <div class="selector-options">
                            <div class="selector-option selected" data-value="{{ product.condition_grade }}">
                                {% if product.condition_grade == 'new' %}
                                    Like New
                                {% elif product.condition_grade == 'excellent' %}
                                    Excellent
                                {% elif product.condition_grade == 'good' %}
                                    Good
                                {% else %}
                                    Fair
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <form method="post" action="{% url 'core:add_to_cart' %}" class="js-add-to-cart">
                        {% csrf_token %}
                        <input type="hidden" name="product_id" value="{{ product.id }}">
                        <input type="hidden" name="quantity" value="1">
                        <input type="hidden" name="selected_color" id="selectedColor" value="">
                        <input type="hidden" name="selected_warranty" id="selectedWarranty" value="">
                        
                        <div class="premium-actions">
                            <button type="submit" class="btn-premium-cart">
                                <i class="fas fa-shopping-cart"></i> Add to Cart
                            </button>
                            <button type="button" class="btn-premium-buy" data-product-id="{{ product.id }}">
                                <i class="fas fa-bolt"></i> Buy Now
                            </button>
                        </div>
                    </form>
                    
                    <!-- Trust Indicators -->
                    <div class="trust-section">
                        <div class="trust-item">
                            <div class="trust-icon">
                                <i class="fas fa-undo"></i>
                            </div>
                            <div class="trust-text">Easy Returns</div>
                        </div>
                        <div class="trust-item">
                            <div class="trust-icon">
                                <i class="fas fa-shipping-fast"></i>
                            </div>
                            <div class="trust-text">Fast Delivery</div>
                        </div>
                        <div class="trust-item">
                            <div class="trust-icon">
                                <i class="fas fa-headset"></i>
                            </div>
                            <div class="trust-text">24/7 Support</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Warranty Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="premium-warranty">
                    <div class="warranty-header">
                        <div class="warranty-icon-large">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div>
                            <h2 class="warranty-title">Extended Warranty Protection</h2>
                            <p style="color: #718096; margin: 0;">Protect your purchase with comprehensive coverage</p>
                        </div>
                    </div>
                    
                    <div class="warranty-options">
                        <div class="warranty-card selected" data-warranty="7-day">
                            <div class="warranty-duration">7-Day Testing</div>
                            <div class="warranty-price">Included Free</div>
                            <ul class="warranty-features">
                                <li>Full functionality testing</li>
                                <li>Free return if issues found</li>
                                <li>Email support</li>
                            </ul>
                        </div>
                        
                        <div class="warranty-card" data-warranty="30-day">
                            <div class="warranty-duration">30-Day Premium</div>
                            <div class="warranty-price">+$29.99</div>
                            <ul class="warranty-features">
                                <li>Extended testing period</li>
                                <li>Priority support</li>
                                <li>Free replacement option</li>
                                <li>Accidental damage coverage</li>
                            </ul>
                        </div>
                        
                        <div class="warranty-card" data-warranty="90-day">
                            <div class="warranty-duration">90-Day Elite</div>
                            <div class="warranty-price">+$59.99</div>
                            <ul class="warranty-features">
                                <li>Maximum protection</li>
                                <li>24/7 premium support</li>
                                <li>Free repairs & replacement</li>
                                <li>Full accidental coverage</li>
                                <li>Money-back guarantee</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Product Details Tabs -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="premium-tabs">
                    <div class="tab-navigation">
                        <button class="tab-btn active" data-tab="details">Product Details</button>
                        <button class="tab-btn" data-tab="specs">Specifications</button>
                        <button class="tab-btn" data-tab="inspection">Inspection Report</button>
                    </div>
                    
                    <div id="details" class="tab-content active">
                        <div class="detail-grid">
                            <div class="detail-row">
                                <span class="detail-label">Category:</span>
                                <span class="detail-value">{{ product.category|title }}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Condition:</span>
                                <span class="detail-value">
                                    {% if product.condition_grade == 'new' %}Like New
                                    {% elif product.condition_grade == 'excellent' %}Excellent
                                    {% elif product.condition_grade == 'good' %}Good
                                    {% else %}Fair{% endif %}
                                </span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Status:</span>
                                <span class="detail-value">{{ product.certification_status|title }}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Stock:</span>
                                <span class="detail-value">{{ product.stock_quantity }} units</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Warranty:</span>
                                <span class="detail-value">{{ product.default_warranty_months }} months</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Listed On:</span>
                                <span class="detail-value">{{ product.created_at|date:"F d, Y" }}</span>
                            </div>
                        </div>
                        
                        {% if product.description %}
                        <div style="margin-top: 2rem; padding: 2rem; background: #f7fafc; border-radius: 12px;">
                            <h3 style="font-size: 1.25rem; font-weight: 700; color: #2d3748; margin-bottom: 1rem;">Description</h3>
                            <p style="color: #4a5568; line-height: 1.8;">{{ product.description }}</p>
                        </div>
                        {% endif %}
                    </div>
                    
                    <div id="specs" class="tab-content">
                        <div class="detail-grid">
                            <div class="detail-row">
                                <span class="detail-label">Category:</span>
                                <span class="detail-value">{{ product.category|title }}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Condition:</span>
                                <span class="detail-value">
                                    {% if product.condition_grade == 'new' %}Like New
                                    {% elif product.condition_grade == 'excellent' %}Excellent
                                    {% elif product.condition_grade == 'good' %}Good
                                    {% else %}Fair{% endif %}
                                </span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Stock Quantity:</span>
                                <span class="detail-value">{{ product.stock_quantity }} units available</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Warranty Period:</span>
                                <span class="detail-value">{{ product.default_warranty_months }} months</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Warranty Available:</span>
                                <span class="detail-value">{% if product.is_warranty_available %}Yes{% else %}No{% endif %}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Listed On:</span>
                                <span class="detail-value">{{ product.created_at|date:"F d, Y" }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="inspection" class="tab-content">
                        <div class="inspection-preview">
                            <div class="inspection-header">
                                <h3 class="inspection-title">
                                    <i class="fas fa-clipboard-check"></i> CertiBuy Inspection Report
                                </h3>
                                <span class="inspection-status">
                                    <i class="fas fa-check-circle"></i> Certified
                                </span>
                            </div>
                            
                            <div class="inspection-grid">
                                <div class="inspection-metric">
                                    <span class="metric-value">{{ product.condition_grade|upper }}</span>
                                    <span class="metric-label">Overall Grade</span>
                                </div>
                                <div class="inspection-metric">
                                    <span class="metric-value">100%</span>
                                    <span class="metric-label">Functional</span>
                                </div>
                                <div class="inspection-metric">
                                    <span class="metric-value">{{ product.created_at|date:"M d, Y" }}</span>
                                    <span class="metric-label">Inspection Date</span>
                                </div>
                            </div>
                            
                            <p style="color: #4a5568; text-align: center; margin: 1.5rem 0 0 0;">
                                This product has been thoroughly inspected and certified by our expert team.
                                All functionality has been tested and verified.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Image Gallery Functionality
document.addEventListener('DOMContentLoaded', function() {
    const mainImage = document.getElementById('mainProductImage');
    const thumbnails = document.querySelectorAll('.premium-thumb');
    
    thumbnails.forEach(thumb => {
        thumb.addEventListener('click', function() {
            const imageUrl = this.dataset.image;
            if (mainImage && imageUrl) {
                mainImage.src = imageUrl;
                thumbnails.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
            }
        });
    });
    
    // Tab Functionality
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    
    tabButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const tabId = this.dataset.tab;
            
            tabButtons.forEach(b => b.classList.remove('active'));
            tabContents.forEach(c => c.classList.remove('active'));
            
            this.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        });
    });
    
    // Selector Options
    const selectorOptions = document.querySelectorAll('.selector-option');
    selectorOptions.forEach(option => {
        option.addEventListener('click', function() {
            const parent = this.parentElement;
            parent.querySelectorAll('.selector-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            this.classList.add('selected');
            
            // Update hidden input if color selector
            if (parent.id === 'colorSelector') {
                document.getElementById('selectedColor').value = this.dataset.value;
            }
        });
    });
    
    // Warranty Selection
    const warrantyCards = document.querySelectorAll('.warranty-card');
    warrantyCards.forEach(card => {
        card.addEventListener('click', function() {
            warrantyCards.forEach(c => c.classList.remove('selected'));
            this.classList.add('selected');
            document.getElementById('selectedWarranty').value = this.dataset.warranty;
        });
    });
    
    // Add to Cart AJAX
    const addToCartForms = document.querySelectorAll('.js-add-to-cart');
    addToCartForms.forEach(form => {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            fetch(this.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Show success notification
                    showNotification('Product added to cart successfully!', 'success');
                    // Update cart count if element exists
                    const cartCount = document.querySelector('.cart-count');
                    if (cartCount && data.cart_count) {
                        cartCount.textContent = data.cart_count;
                    }
                } else {
                    showNotification(data.message || 'Error adding to cart', 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('Error adding to cart', 'error');
            });
        });
    });
});

// Buy Now Function
function buyNow(productId) {
    const selectedColor = document.getElementById('selectedColor')?.value || '';
    const selectedWarranty = document.getElementById('selectedWarranty')?.value || '';
    
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = '{% url "orders:buy_now" %}';
    
    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
    
    form.innerHTML = `
        <input type="hidden" name="csrfmiddlewaretoken" value="${csrfToken}">
        <input type="hidden" name="product_id" value="${productId}">
        <input type="hidden" name="selected_color" value="${selectedColor}">
        <input type="hidden" name="selected_warranty" value="${selectedWarranty}">
    `;
    
    document.body.appendChild(form);
    form.submit();
}

// Add event listener for Buy Now button
document.addEventListener('DOMContentLoaded', function() {
    const buyNowBtn = document.querySelector('.btn-premium-buy');
    if (buyNowBtn) {
        buyNowBtn.addEventListener('click', function() {
            const productId = this.dataset.productId;
            buyNow(productId);
        });
    }
});

// Notification Function
function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 100px;
        right: 20px;
        padding: 1.25rem 2rem;
        background: ${type === 'success' ? 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)' : 'linear-gradient(135deg, #f5576c 0%, #e84393 100%)'};
        color: white;
        border-radius: 12px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        z-index: 10000;
        font-weight: 600;
        animation: slideIn 0.3s ease;
    `;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}
</script>

<style>
@keyframes slideIn {
    from {
        transform: translateX(400px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideOut {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(400px);
        opacity: 0;
    }
}
</style>
{% endblock %}
