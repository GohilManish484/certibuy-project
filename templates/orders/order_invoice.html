{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice {{ order.order_number }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: "Space Grotesk", sans-serif; background: #f8fafc; color: #0f172a; margin: 0; }
        .invoice { max-width: 900px; margin: 2rem auto; background: #fff; padding: 2.5rem; border-radius: 16px; box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08); }
        .invoice-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
        .invoice-header h1 { margin: 0; font-size: 2rem; }
        .invoice-meta { text-align: right; color: #475569; }
        .invoice-section { margin-bottom: 1.5rem; }
        .invoice-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.5rem; }
        table { width: 100%; border-collapse: collapse; margin-top: 1.5rem; }
        th, td { text-align: left; padding: 0.75rem; border-bottom: 1px solid #e2e8f0; }
        th { color: #64748b; font-weight: 600; }
        .total { text-align: right; font-size: 1.1rem; font-weight: 700; }
        .badge { padding: 0.3rem 0.7rem; border-radius: 999px; background: #e2e8f0; font-size: 0.85rem; }
    </style>
</head>
<body>
    <div class="invoice">
        <div class="invoice-header">
            <div>
                <h1>CertiBuy Invoice</h1>
                <p class="badge">Order {{ order.order_number }}</p>
            </div>
            <div class="invoice-meta">
                <div>Placed: {{ order.created_at|date:"M d, Y" }}</div>
                <div>Payment: {{ order.get_payment_method_display }}</div>
            </div>
        </div>

        <div class="invoice-section invoice-grid">
            <div>
                <h3>Bill To</h3>
                {% if order.address %}
                <p>{{ order.address.full_name }}</p>
                <p>{{ order.address.address }}</p>
                <p>{{ order.address.city }}, {{ order.address.state }} {{ order.address.postal_code }}</p>
                <p>{{ order.address.phone }}</p>
                {% else %}
                <p>{{ order.user.get_full_name|default:order.user.username }}</p>
                <p>{{ order.user.email }}</p>
                {% endif %}
            </div>
            <div>
                <h3>Order Summary</h3>
                <p>Status: {{ order.get_status_display }}</p>
                <p>Payment Status: {{ order.get_payment_status_display }}</p>
                {% if order.tracking_id %}
                <p>Tracking ID: {{ order.tracking_id }}</p>
                {% endif %}
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Qty</th>
                    <th>Price</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                {% for item in order.items.all %}
                <tr>
                    <td>{{ item.product.name }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>₹{{ item.price }}</td>
                    <td>₹{{ item.get_total_price }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="invoice-section total">
            <div>Subtotal: ₹{{ order.subtotal }}</div>
            <div>Delivery: ₹{{ order.delivery_charge }}</div>
            <div>Total: ₹{{ order.total_amount }}</div>
        </div>
    </div>
</body>
</html>
